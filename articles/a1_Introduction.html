<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Introduction • CNAqc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="1. Introduction">
<meta property="og:description" content="CNAqc">
<meta property="og:image" content="caravagn.github.io/CNAqc/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNAqc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNAqc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1_Introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/a2_Plots.html">2. Plotting data</a>
    </li>
    <li>
      <a href="../articles/a3_peaks_detection.html">3. QC analysis via peaks detection</a>
    </li>
    <li>
      <a href="../articles/a4_ccf_computation.html">4. Computation of Cancer Cell Fractions</a>
    </li>
    <li>
      <a href="../articles/a5_smoothing.html">5. Smoothing copy number segments</a>
    </li>
    <li>
      <a href="../articles/a6_fragmentation.html">6. Genome fragmentation analysis</a>
    </li>
    <li>
      <a href="../articles/a7_example_MSeq.html">7. Example data analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagnalab/CNAqc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a1_Introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1. Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/CNAqcvignettes/a1_Introduction.Rmd"><code>vignettes/a1_Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>a1_Introduction.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagnalab/CNAqc">CNAqc</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'cli::num_ansi_colors' by</span>
<span class="co">#&gt; 'crayon::num_ansi_colors' when loading 'BMix'</span>
<span class="co">#&gt; Warning: replacing previous import 'crayon::%+%' by 'ggplot2::%+%' when loading</span>
<span class="co">#&gt; 'BMix'</span>
<span class="co">#&gt; ✔ Loading BMix, 'Binomial and Beta-Binomial univariate mixtures'. Support : &lt;https://caravagnalab.github.io/BMix/&gt;</span>
<span class="co">#&gt; ✔ Loading CNAqc, 'Copy Number Alteration quality check'. Support : &lt;https://caravagn.github.io/CNAqc/&gt;</span></code></pre></div>
<p>We discuss the input format and references used in <code>CNAqc</code>.</p>
<div id="input-format" class="section level1">
<h1 class="hasAnchor">
<a href="#input-format" class="anchor"></a>Input format</h1>
<p>You need to provide data for <em>somatic mutations</em>, <em>copy number segments</em> and <em>tumour purity</em>. The package comes with a template dataset available.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load template data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">'example_dataset_CNAqc'</span>, package <span class="op">=</span> <span class="st">'CNAqc'</span><span class="op">)</span></code></pre></div>
<p>These fields are required for <strong>mutation</strong> calls:</p>
<ul>
<li>the mutation location, as <code>chr</code>, <code>from</code>, <code>to</code>.</li>
<li>the mutation reference and alternative alleles <code>ref</code> and <code>alt</code>;</li>
<li>the total number of reads covering the mutated base(s), <code>DP</code> (depth);</li>
<li>the total number of reads covering only the mutant allele(s), <code>NV</code> (number of reads with variant);</li>
<li>the Variant Allele Frequency, <code>VAF</code>, defined as <code>NV/DP</code>.</li>
</ul>
<p>Chromosome names and alleles should be in character format; chromosomes must be in the format <code>chr1</code>, <code>chr2</code>, etc..</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example input SNVs</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">snvs</span> <span class="op">%&gt;%</span> 
        <span class="fu">select</span><span class="op">(</span>
          <span class="va">chr</span>, <span class="va">from</span>, <span class="va">to</span>, <span class="co"># Genomic coordinates</span>
          <span class="va">ref</span>, <span class="va">alt</span>,      <span class="co"># Alleles (reference and alternative)</span>
          <span class="va">DP</span>, <span class="va">NV</span>, <span class="va">VAF</span>    <span class="co"># Read counts (depth, number of variant reads, tumour VAF)</span>
          <span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 12,963 x 8</span>
<span class="co">#&gt;    chr      from      to ref   alt      DP    NV    VAF</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 chr1  1027104 1027105 T     G        60     6 0.1   </span>
<span class="co">#&gt;  2 chr1  2248588 2248589 A     C       127     9 0.0709</span>
<span class="co">#&gt;  3 chr1  2461999 2462000 G     A       156    65 0.417 </span>
<span class="co">#&gt;  4 chr1  2727935 2727936 T     C       180    90 0.5   </span>
<span class="co">#&gt;  5 chr1  2763397 2763398 C     T       183    61 0.333 </span>
<span class="co">#&gt;  6 chr1  2768208 2768209 C     T       203   130 0.640 </span>
<span class="co">#&gt;  7 chr1  2935590 2935591 C     T       228   132 0.579 </span>
<span class="co">#&gt;  8 chr1  2980032 2980033 C     T       196    85 0.434 </span>
<span class="co">#&gt;  9 chr1  3387161 3387162 T     G       124     6 0.0484</span>
<span class="co">#&gt; 10 chr1  3502517 3502518 G     A        88    10 0.114 </span>
<span class="co">#&gt; # … with 12,953 more rows</span></code></pre></div>
<p>Optionally, you can annotate also <em>driver mutations</em>:</p>
<ul>
<li>whether the mutation is a driver, using a boolean flag <code>is_driver</code>;</li>
<li>a <code>driver_label</code> reportin the label to show in the plots with drivers.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">snvs</span> <span class="op">%&gt;%</span> 
        <span class="fu">select</span><span class="op">(</span>
          <span class="va">chr</span>, <span class="va">from</span>, <span class="va">to</span>, <span class="va">ref</span>, <span class="va">alt</span>, <span class="va">is_driver</span>, <span class="va">driver_label</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>
        <span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 12,963 x 13</span>
<span class="co">#&gt;    chr      from     to ref   alt   is_driver driver_label    FILTER    DP    NV</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt;     &lt;chr&gt;           &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 chr1  1027104 1.03e6 T     G     FALSE     C1orf159(ENST0… PASS      60     6</span>
<span class="co">#&gt;  2 chr1  2248588 2.25e6 A     C     FALSE     SKI(dist=7030)… PASS     127     9</span>
<span class="co">#&gt;  3 chr1  2461999 2.46e6 G     A     FALSE     HES5            PASS     156    65</span>
<span class="co">#&gt;  4 chr1  2727935 2.73e6 T     C     FALSE     RP11-740P5.2    PASS     180    90</span>
<span class="co">#&gt;  5 chr1  2763397 2.76e6 C     T     FALSE     RP11-740P5.3(d… PASS     183    61</span>
<span class="co">#&gt;  6 chr1  2768208 2.77e6 C     T     FALSE     RP11-740P5.3(d… PASS     203   130</span>
<span class="co">#&gt;  7 chr1  2935590 2.94e6 C     T     FALSE     RP11-740P5.3(d… PASS     228   132</span>
<span class="co">#&gt;  8 chr1  2980032 2.98e6 C     T     FALSE     LINC00982       PASS     196    85</span>
<span class="co">#&gt;  9 chr1  3387161 3.39e6 T     G     FALSE     ARHGEF16        PASS     124     6</span>
<span class="co">#&gt; 10 chr1  3502517 3.50e6 G     A     FALSE     MEGF6           PASS      88    10</span>
<span class="co">#&gt; # … with 12,953 more rows, and 3 more variables: VAF &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ANNOVAR_FUNCTION &lt;chr&gt;, GENE &lt;chr&gt;</span></code></pre></div>
<p>These fields are required for <strong>copy number segments</strong>:</p>
<ul>
<li>the segment location, as <code>chr</code>, <code>from</code> and <code>to</code>;</li>
<li>the segment absolute number of copies of the major and minor alleles, as <code>Major</code> and <code>minor</code>;</li>
</ul>
<p>In <code>CNAqc</code> format, a diploid balanced segment has <code>Major = minor = 1</code> and will be shortly denoted as <em>karyotype</em> <code>1:1</code>. Similarly, a tetraploid segment has <code>Major = minor = 2</code> and <em>karyotype</em> <code>2:2</code>. A fixed set of colours is used to identify the main karyotypes supported by <code>CNAqc</code>: <code>"1:0"</code>, <code>"2:0"</code>, <code>"1:1"</code>, <code>"2:1"</code> and <code>"2:2"</code>.</p>
<p>Optionally, you can annotate also annotate the Cancer Cell Fraction (CCF) <code>CCF</code> for each segment:</p>
<ul>
<li>segments with <code>CCF = 1</code> are <em>clonal</em>, otherwise <em>subclonal</em>;</li>
<li>by default, if missing, all segments are assumed to be clonal and assigned <code>CCF = 1</code>. Some computations subset only clonal copy number segments (see the manual of each function).</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example input CNA</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">cna</span> <span class="op">%&gt;%</span> 
        <span class="fu">select</span><span class="op">(</span>
          <span class="va">chr</span>, <span class="va">from</span>, <span class="va">to</span>, <span class="co"># Genomic coordinates</span>
          <span class="va">Major</span>, <span class="va">minor</span>  <span class="co"># Number of copies of major/ and minor allele (B-allele)</span>
        <span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 267 x 5</span>
<span class="co">#&gt;    chr       from       to Major minor</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 chr1    840009  1689987     3     2</span>
<span class="co">#&gt;  2 chr1   1689988  1815015     3     2</span>
<span class="co">#&gt;  3 chr1   1815016  9799969     3     2</span>
<span class="co">#&gt;  4 chr1  10479910 12079917     3     2</span>
<span class="co">#&gt;  5 chr1  12079917 12154980     3     2</span>
<span class="co">#&gt;  6 chr1  12154981 12839977     3     2</span>
<span class="co">#&gt;  7 chr1  13780016 17790026     3     2</span>
<span class="co">#&gt;  8 chr1  17849962 21080067     3     2</span>
<span class="co">#&gt;  9 chr1  21080068 21559998     3     2</span>
<span class="co">#&gt; 10 chr1  21559998 24830001     3     2</span>
<span class="co">#&gt; # … with 257 more rows</span></code></pre></div>
<p>Tumour <strong>purity</strong>, defined as the percentage of reads coming from tumour cells), which must be a value in <span class="math inline">\([0, 1]\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example purity</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">purity</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.89</span></code></pre></div>
<p><strong>Note</strong> In the current implementation no use of subclonal copy number segments is done. Most function compute statics only with clonal copy number segments.</p>
<div id="initialisation-of-a-new-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#initialisation-of-a-new-dataset" class="anchor"></a>Initialisation of a new dataset</h2>
<p>To use <code>CNAqc</code>, you need to initialize a <code>cnaqc</code> S3 object with the initialisation function <code>init</code>.</p>
<p>This function will check input formats, and will map mutations to CNA segments. This call does not subset the data, unless there are errors with respect to the required formats. It is required to explicit the reference genome for the assembly (see below).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use SNVs, CNAs and tumour purity (hg19 reference, see below)</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">snvs</span>, 
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">cna</span>,
  <span class="va">example_dataset_CNAqc</span><span class="op">$</span><span class="va">purity</span>,
  ref <span class="op">=</span> <span class="st">'hg19'</span>
  <span class="op">)</span>
<span class="co">#&gt;  [ CNAqc - CNA Quality Check ]</span>
<span class="co">#&gt; ℹ Using reference genome coordinates for: hg19.</span>
<span class="co">#&gt; ℹ Drivers are annotated, but 'gene' column is missing, using mutation location.</span>
<span class="co">#&gt; ! Missing CCF column from CNA calls, adding CCF = 1 assuming clonal CNA calls.</span>
<span class="co">#&gt; ℹ Input n = 12963 mutations for 267 CNA segments (267 clonal, 0 subclonal)</span>
<span class="co">#&gt; ✔ Mapped n = 12963 mutations to clonal segments (100% of input)</span></code></pre></div>
<p>The summary of <code>x</code> can be <code>print</code> to see the number of mutations per karyotype, sorted by size.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; $reference_genome</span>
<span class="co">#&gt; [1] "hg19"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $snvs</span>
<span class="co">#&gt; # A tibble: 12,963 x 17</span>
<span class="co">#&gt;    chr      from      to ref   alt   FILTER    DP    NV    VAF ANNOVAR_FUNCTION</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt;  1 chr1  1027104 1027105 T     G     PASS      60     6 0.1    UTR5            </span>
<span class="co">#&gt;  2 chr1  2248588 2248589 A     C     PASS     127     9 0.0709 intergenic      </span>
<span class="co">#&gt;  3 chr1  2461999 2462000 G     A     PASS     156    65 0.417  upstream        </span>
<span class="co">#&gt;  4 chr1  2727935 2727936 T     C     PASS     180    90 0.5    downstream      </span>
<span class="co">#&gt;  5 chr1  2763397 2763398 C     T     PASS     183    61 0.333  intergenic      </span>
<span class="co">#&gt;  6 chr1  2768208 2768209 C     T     PASS     203   130 0.640  intergenic      </span>
<span class="co">#&gt;  7 chr1  2935590 2935591 C     T     PASS     228   132 0.579  intergenic      </span>
<span class="co">#&gt;  8 chr1  2980032 2980033 C     T     PASS     196    85 0.434  ncRNA_exonic    </span>
<span class="co">#&gt;  9 chr1  3387161 3387162 T     G     PASS     124     6 0.0484 intronic        </span>
<span class="co">#&gt; 10 chr1  3502517 3502518 G     A     PASS      88    10 0.114  intronic        </span>
<span class="co">#&gt; # … with 12,953 more rows, and 7 more variables: GENE &lt;chr&gt;, is_driver &lt;lgl&gt;,</span>
<span class="co">#&gt; #   driver_label &lt;chr&gt;, gene &lt;chr&gt;, type &lt;chr&gt;, karyotype &lt;chr&gt;,</span>
<span class="co">#&gt; #   segment_id &lt;chr&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cna</span>
<span class="co">#&gt; # A tibble: 267 x 10</span>
<span class="co">#&gt;    chr      from      to length covRatio Major minor   CCF segment_id          n</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;</span>
<span class="co">#&gt;  1 chr1   8.40e5  1.69e6 8.50e5     1.19     3     2     1 chr1:840009:16…     1</span>
<span class="co">#&gt;  2 chr1   1.69e6  1.82e6 1.25e5     1.26     3     2     1 chr1:1689988:1…    NA</span>
<span class="co">#&gt;  3 chr1   1.82e6  9.80e6 7.98e6     1.19     3     2     1 chr1:1815016:9…    28</span>
<span class="co">#&gt;  4 chr1   1.05e7  1.21e7 1.60e6     1.19     3     2     1 chr1:10479910:…     1</span>
<span class="co">#&gt;  5 chr1   1.21e7  1.22e7 7.51e4     1.24     3     2     1 chr1:12079917:…    NA</span>
<span class="co">#&gt;  6 chr1   1.22e7  1.28e7 6.85e5     1.19     3     2     1 chr1:12154981:…    NA</span>
<span class="co">#&gt;  7 chr1   1.38e7  1.78e7 4.01e6     1.19     3     2     1 chr1:13780016:…     7</span>
<span class="co">#&gt;  8 chr1   1.78e7  2.11e7 3.23e6     1.19     3     2     1 chr1:17849962:…    12</span>
<span class="co">#&gt;  9 chr1   2.11e7  2.16e7 4.80e5     1.26     3     2     1 chr1:21080068:…    NA</span>
<span class="co">#&gt; 10 chr1   2.16e7  2.48e7 3.27e6     1.19     3     2     1 chr1:21559998:…    11</span>
<span class="co">#&gt; # … with 257 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_snvs</span>
<span class="co">#&gt; [1] 12963</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna</span>
<span class="co">#&gt; [1] 267</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_clonal</span>
<span class="co">#&gt; [1] 267</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_sbclonal</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_karyotype</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   2:2   4:2   3:2   2:1   3:0   2:0  16:2  25:2   3:1 106:1  26:2  99:1 </span>
<span class="co">#&gt;  7478  1893  1625  1563   312    81     4     2     2     1     1     1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $purity</span>
<span class="co">#&gt; [1] 0.89</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l_karyotype</span>
<span class="co">#&gt;        2:2        2:1        3:2        4:2        3:0        2:0        3:1 </span>
<span class="co">#&gt; 1482910013  420405440  357172683  331457138  137498772   39372558     527401 </span>
<span class="co">#&gt;       25:2      106:1        5:0       69:2       26:2       16:2       70:2 </span>
<span class="co">#&gt;     517926     225714     174002     172894     162913     130712      80103 </span>
<span class="co">#&gt;       99:1 </span>
<span class="co">#&gt;      75782 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ploidy</span>
<span class="co">#&gt; [1] 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_prevalent_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $basepairs_by_karyotype</span>
<span class="co">#&gt; # A tibble: 15 x 4</span>
<span class="co">#&gt;    minor Major          n karyotype</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1     2     2 1482910013 2:2      </span>
<span class="co">#&gt;  2     1     2  420405440 2:1      </span>
<span class="co">#&gt;  3     2     3  357172683 3:2      </span>
<span class="co">#&gt;  4     2     4  331457138 4:2      </span>
<span class="co">#&gt;  5     0     3  137498772 3:0      </span>
<span class="co">#&gt;  6     0     2   39372558 2:0      </span>
<span class="co">#&gt;  7     1     3     527401 3:1      </span>
<span class="co">#&gt;  8     2    25     517926 25:2     </span>
<span class="co">#&gt;  9     1   106     225714 106:1    </span>
<span class="co">#&gt; 10     0     5     174002 5:0      </span>
<span class="co">#&gt; 11     2    69     172894 69:2     </span>
<span class="co">#&gt; 12     2    26     162913 26:2     </span>
<span class="co">#&gt; 13     2    16     130712 16:2     </span>
<span class="co">#&gt; 14     2    70      80103 70:2     </span>
<span class="co">#&gt; 15     1    99      75782 99:1     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_mutations_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cnaqc"</span></code></pre></div>
</div>
<div id="subsetting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-data" class="anchor"></a>Subsetting data</h2>
<p>You can <em>subset randomly</em> the data; if drivers are annotated, they can be forced to say in.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y_5000</span> <span class="op">=</span> <span class="fu"><a href="../reference/subsample.html">subsample</a></span><span class="op">(</span><span class="va">x</span>, N <span class="op">=</span> <span class="fl">5000</span>, keep_drivers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;  [ CNAqc - CNA Quality Check ]</span>
<span class="co">#&gt; ℹ Using reference genome coordinates for: GRCh38.</span>
<span class="co">#&gt; ! Missing CCF column from CNA calls, adding CCF = 1 assuming clonal CNA calls.</span>
<span class="co">#&gt; ℹ Input n = 5003 mutations for 267 CNA segments (267 clonal, 0 subclonal)</span>
<span class="co">#&gt; Warning in map_mutations_to_segments(snvs, cna %&gt;% filter(CCF == 1)): [CNAqc] a</span>
<span class="co">#&gt; karyotype column is present in CNA calls, and will be overwritten</span>
<span class="co">#&gt; ✔ Mapped n = 5003 mutations to clonal segments (100% of input)</span>

<span class="co"># 5000 + the ranomd entries that we sampled before</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y_5000</span><span class="op">)</span>
<span class="co">#&gt; $reference_genome</span>
<span class="co">#&gt; [1] "GRCh38"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $snvs</span>
<span class="co">#&gt; # A tibble: 5,003 x 17</span>
<span class="co">#&gt;    chr       from      to ref   alt   FILTER    DP    NV    VAF ANNOVAR_FUNCTION</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt;  1 chr2    1.79e8  1.79e8 C     T     PASS     117    77 0.658  exonic          </span>
<span class="co">#&gt;  2 chr16   6.76e7  6.76e7 C     T     PASS     120    54 0.45   exonic          </span>
<span class="co">#&gt;  3 chr17   7.58e6  7.58e6 G     C     PASS      84    78 0.929  exonic          </span>
<span class="co">#&gt;  4 chr6    1.06e8  1.06e8 A     T     PASS     128    69 0.539  intergenic      </span>
<span class="co">#&gt;  5 chr10   9.09e7  9.09e7 T     A     PASS     123    76 0.618  intergenic      </span>
<span class="co">#&gt;  6 chr3    8.38e7  8.38e7 T     A     PASS     208    70 0.337  intergenic      </span>
<span class="co">#&gt;  7 chr16   2.06e7  2.06e7 T     C     PASS     135    29 0.215  intronic        </span>
<span class="co">#&gt;  8 chr1    9.06e7  9.06e7 A     G     PASS     157    10 0.0637 intergenic      </span>
<span class="co">#&gt;  9 chr2    7.70e7  7.70e7 A     G     PASS     111    71 0.640  intronic        </span>
<span class="co">#&gt; 10 chr6    1.39e8  1.39e8 G     A     PASS     125    65 0.52   intronic        </span>
<span class="co">#&gt; # … with 4,993 more rows, and 7 more variables: GENE &lt;chr&gt;, is_driver &lt;lgl&gt;,</span>
<span class="co">#&gt; #   driver_label &lt;chr&gt;, gene &lt;chr&gt;, type &lt;chr&gt;, karyotype &lt;chr&gt;,</span>
<span class="co">#&gt; #   segment_id &lt;chr&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cna</span>
<span class="co">#&gt; # A tibble: 267 x 10</span>
<span class="co">#&gt;    chr      from      to length covRatio Major minor   CCF segment_id          n</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;</span>
<span class="co">#&gt;  1 chr1   8.40e5  1.69e6 8.50e5     1.19     3     2     1 chr1:840009:16…     1</span>
<span class="co">#&gt;  2 chr1   1.69e6  1.82e6 1.25e5     1.26     3     2     1 chr1:1689988:1…    NA</span>
<span class="co">#&gt;  3 chr1   1.82e6  9.80e6 7.98e6     1.19     3     2     1 chr1:1815016:9…    15</span>
<span class="co">#&gt;  4 chr1   1.05e7  1.21e7 1.60e6     1.19     3     2     1 chr1:10479910:…     1</span>
<span class="co">#&gt;  5 chr1   1.21e7  1.22e7 7.51e4     1.24     3     2     1 chr1:12079917:…    NA</span>
<span class="co">#&gt;  6 chr1   1.22e7  1.28e7 6.85e5     1.19     3     2     1 chr1:12154981:…    NA</span>
<span class="co">#&gt;  7 chr1   1.38e7  1.78e7 4.01e6     1.19     3     2     1 chr1:13780016:…     3</span>
<span class="co">#&gt;  8 chr1   1.78e7  2.11e7 3.23e6     1.19     3     2     1 chr1:17849962:…     5</span>
<span class="co">#&gt;  9 chr1   2.11e7  2.16e7 4.80e5     1.26     3     2     1 chr1:21080068:…    NA</span>
<span class="co">#&gt; 10 chr1   2.16e7  2.48e7 3.27e6     1.19     3     2     1 chr1:21559998:…     3</span>
<span class="co">#&gt; # … with 257 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_snvs</span>
<span class="co">#&gt; [1] 5003</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna</span>
<span class="co">#&gt; [1] 267</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_clonal</span>
<span class="co">#&gt; [1] 267</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_sbclonal</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_karyotype</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  2:2  4:2  3:2  2:1  3:0  2:0 16:2  3:1 26:2 99:1 </span>
<span class="co">#&gt; 2934  701  619  599  101   42    3    2    1    1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $purity</span>
<span class="co">#&gt; [1] 0.89</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l_karyotype</span>
<span class="co">#&gt;        2:2        2:1        3:2        4:2        3:0        2:0        3:1 </span>
<span class="co">#&gt; 1482910013  420405440  357172683  331457138  137498772   39372558     527401 </span>
<span class="co">#&gt;       25:2      106:1        5:0       69:2       26:2       16:2       70:2 </span>
<span class="co">#&gt;     517926     225714     174002     172894     162913     130712      80103 </span>
<span class="co">#&gt;       99:1 </span>
<span class="co">#&gt;      75782 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ploidy</span>
<span class="co">#&gt; [1] 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_prevalent_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $basepairs_by_karyotype</span>
<span class="co">#&gt; # A tibble: 15 x 4</span>
<span class="co">#&gt;    minor Major          n karyotype</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;    </span>
<span class="co">#&gt;  1     2     2 1482910013 2:2      </span>
<span class="co">#&gt;  2     1     2  420405440 2:1      </span>
<span class="co">#&gt;  3     2     3  357172683 3:2      </span>
<span class="co">#&gt;  4     2     4  331457138 4:2      </span>
<span class="co">#&gt;  5     0     3  137498772 3:0      </span>
<span class="co">#&gt;  6     0     2   39372558 2:0      </span>
<span class="co">#&gt;  7     1     3     527401 3:1      </span>
<span class="co">#&gt;  8     2    25     517926 25:2     </span>
<span class="co">#&gt;  9     1   106     225714 106:1    </span>
<span class="co">#&gt; 10     0     5     174002 5:0      </span>
<span class="co">#&gt; 11     2    69     172894 69:2     </span>
<span class="co">#&gt; 12     2    26     162913 26:2     </span>
<span class="co">#&gt; 13     2    16     130712 16:2     </span>
<span class="co">#&gt; 14     2    70      80103 70:2     </span>
<span class="co">#&gt; 15     1    99      75782 99:1     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_mutations_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cnaqc"</span></code></pre></div>
<p>You can also subset data by <em>karyotype of the segments</em>, and by <em>total copy number</em> of the segment. Both subset do not keep drivers that map off the selected segments.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Triploid and copy-neutral LOH segments </span>
<span class="va">y_tripl_cnloh</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_by_segment_karyotype.html">subset_by_segment_karyotype</a></span><span class="op">(</span><span class="va">x</span>, karyotypes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'2:1'</span>, <span class="st">'2:0'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [ CNAqc - CNA Quality Check ]</span>
<span class="co">#&gt; ℹ Using reference genome coordinates for: hg19.</span>
<span class="co">#&gt; ! Missing CCF column from CNA calls, adding CCF = 1 assuming clonal CNA calls.</span>
<span class="co">#&gt; ℹ Input n = 12963 mutations for 58 CNA segments (58 clonal, 0 subclonal)</span>
<span class="co">#&gt; Warning in map_mutations_to_segments(snvs, cna %&gt;% filter(CCF == 1)): [CNAqc] a</span>
<span class="co">#&gt; karyotype column is present in CNA calls, and will be overwritten</span>
<span class="co">#&gt; ✖ n = 11319 mutations  cannot be mapped to segments and will be removed.</span>
<span class="co">#&gt; ✔ Mapped n = 1644 mutations to clonal segments (100% of input)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y_tripl_cnloh</span><span class="op">)</span>
<span class="co">#&gt; $reference_genome</span>
<span class="co">#&gt; [1] "hg19"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $snvs</span>
<span class="co">#&gt; # A tibble: 1,644 x 17</span>
<span class="co">#&gt;    chr      from      to ref   alt   FILTER    DP    NV    VAF ANNOVAR_FUNCTION</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt;  1 chr2   357969  357970 C     A     PASS     104    58 0.558  intergenic      </span>
<span class="co">#&gt;  2 chr2   909304  909305 A     G     PASS      15     7 0.467  ncRNA_intronic  </span>
<span class="co">#&gt;  3 chr2  1035751 1035752 C     T     PASS      93    57 0.613  intronic        </span>
<span class="co">#&gt;  4 chr2  1326719 1326720 A     T     PASS     104    55 0.529  intronic        </span>
<span class="co">#&gt;  5 chr2  1515962 1515963 C     T     PASS      90    50 0.556  intronic        </span>
<span class="co">#&gt;  6 chr2  2198361 2198362 G     T     PASS     125    42 0.336  intronic        </span>
<span class="co">#&gt;  7 chr2  2898536 2898537 C     T     PASS     109    58 0.532  downstream      </span>
<span class="co">#&gt;  8 chr2  3125481 3125482 A     G     PASS     134    35 0.261  ncRNA_intronic  </span>
<span class="co">#&gt;  9 chr2  3832360 3832361 A     T     PASS     120    68 0.567  intergenic      </span>
<span class="co">#&gt; 10 chr2  3878408 3878409 T     A     PASS     126    10 0.0794 intergenic      </span>
<span class="co">#&gt; # … with 1,634 more rows, and 7 more variables: GENE &lt;chr&gt;, is_driver &lt;lgl&gt;,</span>
<span class="co">#&gt; #   driver_label &lt;chr&gt;, gene &lt;chr&gt;, type &lt;chr&gt;, karyotype &lt;chr&gt;,</span>
<span class="co">#&gt; #   segment_id &lt;chr&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cna</span>
<span class="co">#&gt; # A tibble: 58 x 11</span>
<span class="co">#&gt;    chr      from     to length covRatio Major minor k       CCF segment_id     n</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;</span>
<span class="co">#&gt;  1 chr11  1.90e5 2.63e6 2.44e6    0.731     2     1 2:1       1 chr11:190…     9</span>
<span class="co">#&gt;  2 chr11  2.63e6 2.68e6 5.01e4    0.748     2     1 2:1       1 chr11:262…    NA</span>
<span class="co">#&gt;  3 chr11  2.68e6 4.80e6 2.12e6    0.731     2     1 2:1       1 chr11:267…     6</span>
<span class="co">#&gt;  4 chr11  4.91e6 9.94e6 5.03e6    0.731     2     1 2:1       1 chr11:490…    12</span>
<span class="co">#&gt;  5 chr11  9.97e6 1.71e7 7.10e6    0.731     2     1 2:1       1 chr11:997…    12</span>
<span class="co">#&gt;  6 chr11  1.71e7 1.74e7 3.25e5    0.748     2     1 2:1       1 chr11:170…     3</span>
<span class="co">#&gt;  7 chr11  1.74e7 4.89e7 3.15e7    0.731     2     1 2:1       1 chr11:173…   141</span>
<span class="co">#&gt;  8 chr11  5.02e7 5.06e7 4.00e5    0.731     2     1 2:1       1 chr11:501…     2</span>
<span class="co">#&gt;  9 chr11  5.12e7 5.16e7 3.50e5    0.748     2     1 2:1       1 chr11:512…     1</span>
<span class="co">#&gt; 10 chr11  5.50e7 5.54e7 3.60e5    0.731     2     1 2:1       1 chr11:549…     1</span>
<span class="co">#&gt; # … with 48 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_snvs</span>
<span class="co">#&gt; [1] 1644</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna</span>
<span class="co">#&gt; [1] 58</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_clonal</span>
<span class="co">#&gt; [1] 58</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_sbclonal</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_karyotype</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  2:1  2:0 </span>
<span class="co">#&gt; 1563   81 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $purity</span>
<span class="co">#&gt; [1] 0.89</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l_karyotype</span>
<span class="co">#&gt;       2:1       2:0 </span>
<span class="co">#&gt; 420405440  39372558 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ploidy</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_prevalent_karyotype</span>
<span class="co">#&gt; [1] "2:1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $basepairs_by_karyotype</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   minor Major         n karyotype</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1     1     2 420405440 2:1      </span>
<span class="co">#&gt; 2     0     2  39372558 2:0      </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_mutations_karyotype</span>
<span class="co">#&gt; [1] "2:1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cnaqc"</span>

<span class="co"># Two and four copies</span>
<span class="va">y_2_4</span> <span class="op">=</span> <span class="fu"><a href="../reference/subset_by_segment_totalcn.html">subset_by_segment_totalcn</a></span><span class="op">(</span><span class="va">x</span>, totalcn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [ CNAqc - CNA Quality Check ]</span>
<span class="co">#&gt; ℹ Using reference genome coordinates for: hg19.</span>
<span class="co">#&gt; ℹ Input n = 12963 mutations for 90 CNA segments (90 clonal, 0 subclonal)</span>
<span class="co">#&gt; Warning in map_mutations_to_segments(snvs, cna %&gt;% filter(CCF == 1)): [CNAqc] a</span>
<span class="co">#&gt; karyotype column is present in CNA calls, and will be overwritten</span>
<span class="co">#&gt; ✖ n = 5402 mutations  cannot be mapped to segments and will be removed.</span>
<span class="co">#&gt; ✔ Mapped n = 7561 mutations to clonal segments (100% of input)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y_2_4</span><span class="op">)</span>
<span class="co">#&gt; $reference_genome</span>
<span class="co">#&gt; [1] "hg19"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $snvs</span>
<span class="co">#&gt; # A tibble: 7,561 x 17</span>
<span class="co">#&gt;    chr      from      to ref   alt   FILTER    DP    NV    VAF ANNOVAR_FUNCTION</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           </span>
<span class="co">#&gt;  1 chr4    54939   54940 C     A     PASS     718    44 0.0613 intronic        </span>
<span class="co">#&gt;  2 chr4   573969  573970 G     C     PASS     164    16 0.0976 intergenic      </span>
<span class="co">#&gt;  3 chr4  1108141 1108142 G     A     PASS     157    66 0.420  ncRNA_intronic  </span>
<span class="co">#&gt;  4 chr4  1395352 1395353 C     T     PASS     178    93 0.522  intergenic      </span>
<span class="co">#&gt;  5 chr4  1537972 1537973 G     A     PASS     155    68 0.439  intergenic      </span>
<span class="co">#&gt;  6 chr4  1565793 1565794 C     T     PASS     172    77 0.448  intergenic      </span>
<span class="co">#&gt;  7 chr4  1600312 1600313 G     A     PASS     139    61 0.439  intergenic      </span>
<span class="co">#&gt;  8 chr4  1801455 1801456 G     A     PASS     161    79 0.491  intronic        </span>
<span class="co">#&gt;  9 chr4  2289980 2289981 C     T     PASS     168    74 0.440  intronic        </span>
<span class="co">#&gt; 10 chr4  2358143 2358144 T     G     PASS     100     6 0.06   intronic        </span>
<span class="co">#&gt; # … with 7,551 more rows, and 7 more variables: GENE &lt;chr&gt;, is_driver &lt;lgl&gt;,</span>
<span class="co">#&gt; #   driver_label &lt;chr&gt;, gene &lt;chr&gt;, type &lt;chr&gt;, karyotype &lt;chr&gt;,</span>
<span class="co">#&gt; #   segment_id &lt;chr&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cna</span>
<span class="co">#&gt; # A tibble: 90 x 12</span>
<span class="co">#&gt;    chr      from      to length covRatio Major minor   CCF segment_id        n.x</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;</span>
<span class="co">#&gt;  1 chr1   1.45e8  1.46e8 8.20e5    1.04      2     2     1 chr1:144920087…    NA</span>
<span class="co">#&gt;  2 chr12  1.60e5  3.48e7 3.47e7    0.950     2     2     1 chr12:160107:3…   131</span>
<span class="co">#&gt;  3 chr12  3.80e7  3.83e7 2.70e5    1.04      2     2     1 chr12:38000003…    NA</span>
<span class="co">#&gt;  4 chr12  3.83e7  5.18e7 1.35e7    0.950     2     2     1 chr12:38270005…    36</span>
<span class="co">#&gt;  5 chr12  5.18e7  5.20e7 1.67e5    0.505     2     0     1 chr12:51831429…    NA</span>
<span class="co">#&gt;  6 chr12  5.20e7  5.21e7 6.44e4    0.950     2     2     1 chr12:51998742…    NA</span>
<span class="co">#&gt;  7 chr12  5.21e7  5.80e7 5.95e6    0.505     2     0     1 chr12:52063102…     7</span>
<span class="co">#&gt;  8 chr12  5.84e7  6.70e7 8.66e6    0.505     2     0     1 chr12:58353990…    21</span>
<span class="co">#&gt;  9 chr12  6.72e7  6.74e7 1.34e5    0.505     2     0     1 chr12:67235088…    NA</span>
<span class="co">#&gt; 10 chr12  6.74e7  1.33e8 6.61e7    0.950     2     2     1 chr12:67369494…   335</span>
<span class="co">#&gt; # … with 80 more rows, and 2 more variables: total_cn &lt;dbl&gt;, n.y &lt;int&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_snvs</span>
<span class="co">#&gt; [1] 7561</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna</span>
<span class="co">#&gt; [1] 90</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_clonal</span>
<span class="co">#&gt; [1] 90</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_cna_sbclonal</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_karyotype</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  2:2  2:0  3:1 </span>
<span class="co">#&gt; 7478   81    2 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $purity</span>
<span class="co">#&gt; [1] 0.89</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l_karyotype</span>
<span class="co">#&gt;        2:2        2:0        3:1 </span>
<span class="co">#&gt; 1482910013   39372558     527401 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ploidy</span>
<span class="co">#&gt; [1] 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_prevalent_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $basepairs_by_karyotype</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   minor Major          n karyotype</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;int&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1     2     2 1482910013 2:2      </span>
<span class="co">#&gt; 2     0     2   39372558 2:0      </span>
<span class="co">#&gt; 3     1     3     527401 3:1      </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $most_mutations_karyotype</span>
<span class="co">#&gt; [1] "2:2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cnaqc"</span></code></pre></div>
</div>
<div id="reference-genome-coordinates" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-genome-coordinates" class="anchor"></a>Reference genome coordinates</h2>
<p><code>CNAqc</code> contains two coordinates for two reference genomes, <code>hg19</code> and <code>GRCh38</code> (default). For each reference genome the package stores the location of the chromosomes, and their centromers; you can access these data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">CNAqc</span><span class="fu">:::</span><span class="fu">get_reference</span><span class="op">(</span><span class="st">"hg19"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 24 x 6</span>
<span class="co">#&gt;    chr      length       from         to centromerStart centromerEnd</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 chr1  249250621          0  249250621      121535434    124535434</span>
<span class="co">#&gt;  2 chr2  243199373  249250621  492449994      341576792    344576792</span>
<span class="co">#&gt;  3 chr3  198022430  492449994  690472424      582954848    585954848</span>
<span class="co">#&gt;  4 chr4  191154276  690472424  881626700      740132541    743132541</span>
<span class="co">#&gt;  5 chr5  180915260  881626700 1062541960      928032341    931032341</span>
<span class="co">#&gt;  6 chr6  171115067 1062541960 1233657027     1121372126   1124372126</span>
<span class="co">#&gt;  7 chr7  159138663 1233657027 1392795690     1291711358   1294711358</span>
<span class="co">#&gt;  8 chr8  146364022 1392795690 1539159712     1436634577   1439634577</span>
<span class="co">#&gt;  9 chr9  141213431 1539159712 1680373143     1586527391   1589527391</span>
<span class="co">#&gt; 10 chr10 135534747 1680373143 1815907890     1719628078   1722628078</span>
<span class="co">#&gt; # … with 14 more rows</span>

<span class="fu">CNAqc</span><span class="fu">:::</span><span class="fu">get_reference</span><span class="op">(</span><span class="st">"GRCh38"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 24 x 6</span>
<span class="co">#&gt;    chr      length       from         to centromerStart centromerEnd</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 chr1  248956422          0  248956422      122026459    124849229</span>
<span class="co">#&gt;  2 chr2  242193529  248956422  491149951      341144567    341144567</span>
<span class="co">#&gt;  3 chr3  198295559  491149951  689445510      581922409    582703370</span>
<span class="co">#&gt;  4 chr4  190214555  689445510  879660065      739157571    739157571</span>
<span class="co">#&gt;  5 chr5  181538259  879660065 1061198324      926145965    929381368</span>
<span class="co">#&gt;  6 chr6  170805979 1061198324 1232004303     1119752212   1119752212</span>
<span class="co">#&gt;  7 chr7  159345973 1232004303 1391350276     1290173956   1293382091</span>
<span class="co">#&gt;  8 chr8  145138636 1391350276 1536488912     1435384020   1435384020</span>
<span class="co">#&gt;  9 chr9  138394717 1536488912 1674883629     1579878547   1579878547</span>
<span class="co">#&gt; 10 chr10 133797422 1674883629 1808681051     1714570311   1716429449</span>
<span class="co">#&gt; # … with 14 more rows</span></code></pre></div>
<p>The reference genomes can be specified as a parameter once you create a <code>CNAqc</code> object. Coordinates are used to translate relative to absolute genome coordinates of somatic mutations and CNA segments; this is done only when plotting the data. Note that mapping of mutations to CNA segments is independent of the reference genome, and it will work as far as both mutation and CNA segments are mapped to the same reference.</p>
<p>You can use a hidden function to plot a reference, and make it explicit with a title.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">CNAqc</span><span class="fu">:::</span><span class="fu">blank_genome</span><span class="op">(</span>ref <span class="op">=</span> <span class="st">'hg19'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"HG19 genome reference"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="a1_Introduction_files/figure-html/unnamed-chunk-12-1.png" width="912"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.caravagnalab.org">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
